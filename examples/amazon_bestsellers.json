{
  "name": "Amazon Best Sellers Scraper - Optimized",
  "description": "Scrapes Amazon best sellers with complete URL hierarchy tracking and structured data extraction",
  "config": {
    "start_urls": [
      "https://www.amazon.com/Best-Sellers/zgbs"
    ],
    "max_depth": 4,
    "max_pages": 1000,
    "rate_limit_delay": 2000,
    "storage": {
      "type": "database"
    },
    "url_discovery": [
      {
        "id": "discover_main_categories",
        "type": "extract_links",
        "name": "Discover Main Categories",
        "params": {
          "selector": "#zg_browseRoot .zg_browseRoot a, ._p13n-zg-nav-tree-all_style_zg-browse-item__1rdKf a",
          "url_type": "category",
          "filter": {
            "pattern": ".*/Best-Sellers.*",
            "exclude_pattern": ".*ref=.*nav.*",
            "max_links": 30
          }
        }
      },
      {
        "id": "discover_subcategories",
        "type": "extract_links",
        "name": "Discover Subcategories",
        "params": {
          "selector": "#zg_browseRoot ul li a, ._p13n-zg-nav-tree-all_style_zg-browse-item__1rdKf a",
          "url_type": "subcategory",
          "filter": {
            "pattern": ".*/Best-Sellers.*",
            "exclude_pattern": ".*ref=.*nav.*",
            "max_links": 20
          }
        },
        "dependencies": ["discover_main_categories"]
      },
      {
        "id": "discover_products",
        "type": "extract_links",
        "name": "Discover Product Links",
        "params": {
          "selector": ".p13n-desktop-grid .a-link-normal, .zg-grid-general-faceout a.a-link-normal, div[data-asin] a.a-link-normal",
          "url_type": "product",
          "filter": {
            "pattern": ".*/dp/[A-Z0-9]{10}.*",
            "exclude_pattern": ".*(offer-listing|customer-reviews|product-reviews).*",
            "max_links": 100
          }
        }
      },
      {
        "id": "discover_pagination",
        "type": "extract_links",
        "name": "Discover Pagination Links",
        "params": {
          "selector": ".a-pagination .a-last a, .a-pagination li:not(.a-disabled) a",
          "url_type": "pagination",
          "filter": {
            "pattern": ".*pg=[0-9]+.*",
            "max_links": 5
          }
        }
      }
    ],
    "data_extraction": [
      {
        "id": "extract_product_data",
        "type": "extract",
        "name": "Extract Product Data",
        "params": {
          "schema": "amazon_product",
          "wait_for": "#productTitle, #title",
          "fields": {
          "title": {
            "selector": "#productTitle, #title",
            "type": "text",
            "transform": "trim"
          },
          "price": {
            "selector": ".a-price .a-offscreen, #priceblock_ourprice, #priceblock_dealprice, .a-price-whole",
            "type": "text",
            "transform": "extract_number"
          },
          "currency": {
            "selector": ".a-price-symbol",
            "type": "text",
            "default": "USD"
          },
          "rating": {
            "selector": "#acrPopover .a-icon-alt, .a-icon-star .a-icon-alt, [data-hook='rating-out-of-text']",
            "type": "text",
            "transform": "extract_rating"
          },
          "review_count": {
            "selector": "#acrCustomerReviewText, [data-hook='total-review-count']",
            "type": "text",
            "transform": "extract_number"
          },
          "availability": {
            "selector": "#availability span, #availability-brief",
            "type": "text",
            "transform": "trim"
          },
          "brand": {
            "selector": "#bylineInfo, .po-brand .po-break-word",
            "type": "text",
            "transform": "trim"
          },
          "asin": {
            "selector": "input[name='ASIN'], th:contains('ASIN') + td",
            "type": "text"
          },
          "bestseller_rank": {
            "selector": "#SalesRank, #productDetails_detailBullets_sections1 tr:contains('Best Sellers Rank') td, th:contains('Best Sellers Rank') + td",
            "type": "text"
          },
          "features": {
            "selector": "#feature-bullets li span.a-list-item, #featurebullets_feature_div li span",
            "type": "list",
            "multiple": true
          },
          "description": {
            "selector": "#productDescription p, #feature-bullets",
            "type": "text"
          },
          "image_url": {
            "selector": "#landingImage, #imgBlkFront",
            "type": "attribute",
            "attribute": "src"
          },
          "categories": {
            "selector": "#wayfinding-breadcrumbs_feature_div a, .a-breadcrumb a",
            "type": "list",
            "multiple": true
          }
        },
          "data_extraction_patterns": [
            ".*/dp/[A-Z0-9]{10}.*"
          ]
        }
      }
    ]
  },
  "status": "active"
}
